# 本番用

## トップ - 吉田
情報科学科の小松, 多田, 吉田です。よろしくお願いします。  
私たちのテーマは`自動運転の一括制御`です。

目次です。  
- はじめに
- 問題提起・目標
- システムについて
- 検証 1回目
- 検証 2回目
- 結論・感想


## はじめに - 吉田
4月末に自動運転について研究しようとしたところ、  
より広い視野で研究しようと思い、科学技術化の5分野で協力することにしました。  
最終的に`未来の都市における自動運転`をテーマに、  
- `機械分野` には自動運転用の 車体の設計を、
- `電子分野` は車の機体の制御、
- `電気分野` はワイヤレス給電のシステムを、
- `情報科` の私たちは自動運転の一括制御を、
- そして `都市環境分野` に街全体の設計を担当してもらうことにしました。  

5分野で話し合い、街は完全に歩車分離がされ、車も全て自動運転化されている未来で、  
その中でも今回は片側一車線の道路を想定しています。  


## 問題提起・目標 - 吉田
現在の自動運転では画像認識が主体ですが、気候などの条件により認識の精度が落ちるという問題が起きています。  
そこで私たちは画像認識に頼らないタグを用いた新しい自動運転のシステムを開発することにしました。  
タグを用いることで、全ての車を一括制御することにより無駄な一時停止を減らし、  
混雑の緩和にも役立つシステムになると考えました。


## システムについて - 多田
新システムは交差点にタグがあり、1つ目を通ると接続報告されます。  
サーバーでは進入できるかの判断をし、これを返します。  
通過後は車から通過報告をし、通信を終了します。  

判断する条件は以下のようになっています。  
> 自分: 待機中の車  
> 相手: 進入中の車  
> 
> 拒否: 自分の待機しているレーンに進入不可の車がある  
> 
> 許可: 自分と相手の来る方が同じ  
> 
> 拒否: 自分の行き先と相手の行き先が同じ  
>  
> 自分が直進のとき
> - 拒否: 相手が自分の左側から来る  
> - 拒否: 相手が自分の左側へ行く  
> 
> 自分が右折のとき
> - 拒否: 相手が左から来て前に行く
> - 拒否: 相手が前から来て左に行く
> - 許可: 相手が右から来て手前に行く

直進する場合の一例を見てみると、  
`左側から相手が来るか` を判断するだけで  

自分が`北`にいて、相手が`東`から来る場合、  
`東`にいて、相手が`南`から来るなど、  
東西南北の4パターンあり、判断手順が増えてしまいます。  

> - 自分が`北`にいて、相手が`東`から来る場合
> - 自分が`東`にいて、相手が`南`から来る場合
> - 自分が`南`にいて、相手が`西`から来る場合
> - 自分が`西`にいて、相手が`北`から来る場合

ここで`北を0, 東を1, 南2, 西3` `左折を1, 直進2, 右折3`とすることにより、処理を効率化することができました。  
> - `相手の来る方` == `自分の来る方 + 1`  

はじめに、Python3.8を使用し、socket通信で車側と通信するプログラムを制作しました。  
今回、他の分野と合わせる前に、1からシミュレーターを制作し、検証することにしました。  


## 検証 1回目- 吉田
### 検証内容について
シミュレーターは信号と新システム2つを制作しました。  

信号は現在のものを再現し、新システムの1つ目は来た車から1台ずつ進入するようにしたもので、  
2つ目は先ほどの動画のように同時に進入できるようにしたものです。  
これらをnew1、new2と呼ぶことにします。  

交差点単体に着目し、ランダムな方角から方角へ移動する車を5分間の処理数と待機数で比較します。  


### 検証結果
こちらが結果をグラフ化したものです。  
> ![1-処理数](https://docs.google.com/spreadsheets/d/e/2PACX-1vSDcloY71481hB0FpkomezlnNjGZpPEFegFVnGm2JX5h_pkD8_AO-UcSNwicodauZi7aXvQntKbFgBz/pubchart?oid=1751094130&format=image)  
> ![1-待機数](https://docs.google.com/spreadsheets/d/e/2PACX-1vSDcloY71481hB0FpkomezlnNjGZpPEFegFVnGm2JX5h_pkD8_AO-UcSNwicodauZi7aXvQntKbFgBz/pubchart?oid=1814756461&format=image)  

グラフからnew1は同時進入できなく処理数が制限されるため、一定となってしまいました。  
それに対しnew2の混雑時は信号に勝っています。  
次第に等しくなっていますが、待機数が限りなく少ないため共に車を捌き切れていると分かります。  

交差点単体では、同時進入の重要性など良い結果が得られましたが、  
より現実に近づけるため、次はマップ全体として検証しました。  


## 検証 2回目 - 多田
### システム変更点・検証方法
変更点として、およそ碁盤の目状のマップでランダムな交差点から交差点へと移動します。  
経路探索には `Astarアルゴリズム` を使用します。     
また、交差点が混雑していた場合はそこを回避する仕様のものも比較します。  


### 検証結果
こちらも同様にグラフ化しました。  

> ![2-処理数](https://docs.google.com/spreadsheets/d/e/2PACX-1vSDcloY71481hB0FpkomezlnNjGZpPEFegFVnGm2JX5h_pkD8_AO-UcSNwicodauZi7aXvQntKbFgBz/pubchart?oid=522272234&format=image)  
> ![2-待機数](https://docs.google.com/spreadsheets/d/e/2PACX-1vSDcloY71481hB0FpkomezlnNjGZpPEFegFVnGm2JX5h_pkD8_AO-UcSNwicodauZi7aXvQntKbFgBz/pubchart?oid=1762092698&format=image)  

処理数のグラフを見てみると信号に比べてnew2は処理数が多い理想的な状態だとわかりました。  
これは交差点単体での遅延は少なくても経路全体とすると大きくなってしまっているからだと考えられます。  

また、待機数のグラフより、信号は混雑度に関わらず一定数以上待機する必要がありますが、  
new2はあまり待機する必要がなくなっていることが分かります。  

しかし、信号もnew2も混雑回避の仕組みは、想像以上に効果が小さい結果となりました。  
ただし、これは今回作ったシミュレーションのマップが小さく、回避できる経路に限りがあったためと思われます。  
今後、都市環境分野が設計した街全体で検証してみたいと思います。  


## 結論・感想 - 多田
結論として、システムの有効性を確認することができました。  
今後は、各分野との最終調整を行いながら、改良を重ね、より現実的なシステムにしたいと思います。  

最後に各分野の成果をお見せします。  
- こちらは、シミュレーションの様子です。  
- 機械、電子、電気分野です。  
- 最後に都市環境分野です。  

以上です。ご清聴ありがとうございました。  
fin
