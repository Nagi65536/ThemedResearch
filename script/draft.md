# 下書き

## 前提条件
前提条件です  
街は完全に歩車分離がされていて、車も全て自動運転化されている未来です  
この街の設計などは建築分野、  
車本体は機械分野、  
車内部の制御は電子・電気分野が制作していて  
僕たちは街中、特に交差点における制御の効率化を担当しました  

## 問題提起・目標
現在の自動運転ではカメラを主体として使用していますがそこには問題があると考えました  
カメラでは気候により視界が悪くなったり、大型トラックや曲がり角など、視認出来ない部分があります  

また、現在の交差点は他に車がない場合でも止まらなければならないなど柔軟性に掛けていて、完全自動化された世界では効率的では無いと考えました  

目標は、全ての車を一元管理し、停止する時間を限りなく減らし効率的に目的地に到着させることです  

## システムについて
今回使用した言語はPython3.8 で、  
データベースはsqlite  
通信手段としてsocket通信  
ライブラリは  
・socket  
・conccurent.futures  
・sqlite3  
を使用しました。  

初めに交差点にはこのようにタグが配置されています。1つ目のタグを通るとサーバーに接続したと報告されます。サーバー側ではデータベースに接続情報が登録されます  
このデータを元に交差点に進入できるかの判断がされ、進入の可否が車側に返されます  
交差点通過後は通過報告をし、この交差点での通信を終了します  

## 信号のメリット・デメリット
信号の大きなメリットは交通整備が容易であることでしょう
時間単位で分離することで利用者にもわかりやすく、それでいて交通事故の低減が狙えます
デメリットは非混雑時の無駄な一時停止がまず挙げられます
また地域によっては気象条件にも影響されます

## タグ検知のメリット・デメリット
交差点侵入の可否情報が即座に車側に渡されるので無駄な一時停止が減ります
システムが独立しているため処理が周辺環境に依存しない
デメリットは認識できなかった時の不安感

また双方共通のリスクとしてメンテナンスが必要ということが挙げられます



## 一回目の結果・考察・改善点
### 検証方法
- 交差点単体に着目
- ランダムな方向からランダムな方向へ移動

### 検証
`TODO`  
まず信号の処理にかかる時間を状況別で確認しました
信号の処理にかかった時間でタグ検知では何台とおるかを測定し比較対象とする

確かに車が少ないときはタグ検知は信号よりは効率的ですが、交互に登録された場合や混雑時には非効率となってしまいます
また混雑している交差点を未然に回避することができたらさらに効率が良くなると考えます

## 二回目の結果・考察・改善点
### システム変更点
システムの変更点として
- 環境は交差点単体ではなく、大体碁盤の目状のマップ
- ランダムな交差点からランダムな交差点へ経路で基本最短経路で移動する
- 最短経路探索には Astarアルゴリズム を使用
- 混雑していた場合は別の迂回路を検索する

`TODO` 混雑回避の仕方を詳しく

### 比較内容
- 一定時間経過後に処理した台数
- 一定時間経過後に交差点で順番待ちしている台数

**グラフ**

### 結果・考察
改善後では待機中の車が `0.35` と少ないのに対し、信号では `66.45` と非常に多いです。
信号待ちをする必要がないことによるメリットが出ていると思われます。  

改善後では 混雑回避あり・なし を比較するとあまり差がなく**混雑回避の効果があまり出ませんでした**。  
それに対し信号では `処理数` には差がありませんが、 `待機数` が `約1.5倍` と効果が現れていました。  
これは、待機車が少し増えただけでも信号の周期によっては待機時間が伸びてしまうからだと思いました。  


## 結論
`TODO`  
